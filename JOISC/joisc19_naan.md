# Naan

## 문제

JOI 카레점은 무척 긴 난을 파는 것으로 유명하다. 이 가게는 난에 $L$ 종류의 맛을 내고 있으며, 맛은 각 1 이상 L 이하의 정수로 번호가 매겨져 있다. 이 가게의 주요 상품인 JOI 스페셜 난은 길이가 $L$cm이고, 왼쪽에서 $j - 1$cm부터 $j$cm의 부분은 맛 $j$로 맛을 내고 있다$(1 \leq j \leq L)$.

당신은 배가 고파져서, 점심밥을 먹으로 $N$명이서 JOI 카레점에 왔다. 모두 함께 하나의 JOI 스페셜 난을 먹는다. 사람에 따라 맛의 취향은 다르다. $i$번째$(1 \leq i \leq N)$ 사람은 맛 $j(1 \leq j \leq L)$로 맛을 낸 난을 먹으면 cm 당 $V_{i,j}$의 행복도를 얻는다.

당신은 JOI 스페셜 난을 $N$개의 조각으로 잘라 모두에게 분배하기로 하였다. 구체적으로, 이하의 순서로 난을 분배한다.

1. $N - 1$개의 유리수 $0 < X_{1} < X_{2} < \cdots < X_{N-1} < L$을 결정한다.

2. $N$개의 정수 $P_{1}, P_{2}, \cdots, P_{N}$을 결정한다. 이는 $1$ 이상 $N$ 이하의 정수의 순열이어야 한다.

3. 각 정수 $k(1 \leq k \leq N - 1)$에 대해 난의 왼쪽에서 $X_{k}$cm의 위치를 자른다. 이를 통해, 난은 $N$개 조각으로 나뉜다.

4. 각 정수 $k(1 \leq k \leq N)$에 대해 난의 왼쪽에서 $X_{k-1}$cm부터 $X_{k}$cm까지의 부분의 조각을 $P_{k}$번째 사람에게 제공한다. 여기서 $X_{0} = 0, X_{N} = L$이라 하자.

사람에 따라 맛의 취향이 다르기에, 되도록이면 공평하게 분배하려 한다. 모든 사람에 대해 JOI 스페셜 난을 혼자 먹었을 때 행복도의 $\frac{1}{N}$ 이상의 행복도를 얻을 수 있는 분배를 공평한 분배라 한다. 당신의 목표는 공평한 분배를 하나 찾는 것이다.

사람들의 맛의 취향이 주어졌을 때 공평한 분배가 가능한지를 판단해 가능하다면 공평한 분배를 하나 구하는 프로그램을 작성하라.

## 입력

입력은 이하의 형식으로 표준 입력으로 주어진다. 입력의 모든 값은 정수이다.

$N \quad L$

$V_{1,1} \quad V_{1,2} \cdots V_{1,L}$

$\vdots$

$V_{N,1} \quad V_{N,2} \cdots V_{N,L}$

## 출력

공평한 분배가 불가능한 경우, 표준 출력으로 -1을 출력한다. 공평한 분배가 가능한 경우, 표준 출력으로 그 분배를 나타내는 $N-1$개의 유리수 $X_{1}, \cdots, X_{N - 1}$과 $N$개의 정수 $P_{1}, \cdots P_{N}$을 이하의 형식으로 출력한다.

$A_{1} \quad B_{1}$

$A_{1} \quad B_{1}$

$\vdots$

$A_{N - 1} \quad B_{N - 1}$

$P_{1} \quad P_{2} \cdots P_{N}$

여기서 $A_{k}, B_{k}$는 $X_{k}=\frac{A_{k}}{B_{k}}$을 만족하는 정수의 쌍이다 $(1 \leq k \leq N - 1)$. 이 정수들은 출력 제약 조건을 만족해야 한다.

## 입력 제약

* $2 \leq N \leq 2000$

* $1 \leq L \leq 2000$

* $1 \leq V_{i,j} \leq 100000(1 \leq i \leq N, 1 \leq j \leq L)$

## 출력 제약

공평한 분배가 가능한 경우, 출력은 이하의 제약을 만족해야 한다.

* $1 \leq B_{k} \leq 1000000000(1 \leq k \leq N-1)$

* $0 < \frac{A_{1}}{B_{1}} < \frac{A_{2}}{B_{2}} < \cdots < \frac{A_{N-1}}{B_{N-1}} < L$

* $P_{1}, \cdots, P_{N}$은 $1$ 이상 $N$ 이하의 정수의 순열이어야 한다.

* 출력의 분배에 대해 $i$번째 사람의 행복도는 $\frac{V_{i,1} + V_{i,2} + \cdots + V_{i,L}}{N}$ 이상이어야 한다.$(1 \leq i \leq N)$

또, $A_{k}$와 $B_{k}$는 서로소가 아니어도 괜찮다.

이 문제의 제약조건 내에서 공정한 분배가 존재한다면 $1 \leq B_{k} \leq 1000000000$을 만족하는 올바른 출력이 있음을 증명할 수 있다.

## 서브태스크

1. $N = 2$(5점)

2. $N \leq 6, V_{i,j} \leq 10(1 \leq i \leq N, 1 \leq j \leq L)$(24점)

3. 추가 제약 조건이 없다.(71점)

# 풀이

## 서브태스크 1

$N=2$이다. 사람 1과 사람 2에 대해 각자 행복도의 정확히 절반이 되는 분할 위치가 존재한다. 분할 위치가 동일할 경우 그 위치에서 분할하면 되므로 답이 자명하다.

일반성을 잃지 않고 사람 1의 분할 위치가 더 왼쪽에 위치한다 하자. 사람 1은 전체 행복도에서 정확히 절반에 해당하는 행복도를 얻을 수 있고, 사람 2는 전체 행복도의 절반보다 많은 행복도를 얻을 수 있으므로 문제의 조건을 만족하는 분할이다.

## 서브태스크 2

서브태스크 1의 풀이를 응용하여 $N$이 보다 일반적인 상황에서의 풀이를 생각해 보자.

각 사람에 대해 왼쪽에서부터 행복도가 전체 행복도의 $\frac{1}{N}$이 되는 지점을 모두 표시하고, 그 중 가장 왼쪽에 있는 사람에게 그 부분을 배당한다. 그러면 나머지의 사람들에 대해서는 전체 행복도의 $\frac{N-1}{N}$ 이상에 해당하는 난이 남아있다. 이 과정을 재귀적으로 반복할 수 있다. 따라서 해는 항상 존재한다.

다만 이때 분할 위치를 분수로 표현하면 $B_{i}$의 값이 커져 전체 문제를 해결할 수는 없고, 서브태스크 2를 해결할 수 있다.

## 서브태스크 3

서브태스크 2의 풀이는 재귀적으로 풀이를 적용하여 $B_{i}$의 값이 커지는 데에 문제점이 있다. 전체 행복도의 $\frac{1}{N}$이 되는 지점을 구하고 자르는 과정을 반복하지 말고, 각 사람에 대해 전체 행복도의 $\frac{1}{N}, \frac{2}{N}, \cdots, \frac{N-1}{N}$이 되는 지점을 모두 구한 후 1번째로 $\frac{1}{N}$ 지점을 비교, 두번째로 $\frac{2}{N}$ 지점을 비교하는 방식을 반복해도 같은 논리가 성립한다. 이때 $B_i$의 크기는 $N \times V$ 정도이므로 충분히 작다.
